/* hide ugly animation */
.sidebar-animation-screenshot {visibility: collapse !important;}

#sidebar-main{
  --txt-color: var(--bg-txt);
  background: transparent !important;
  overflow: visible !important;
}

/* new sidebar panel */
.wrapper:has(.tools-and-extensions) {
  -moz-window-dragging: drag !important;
  & * {-moz-window-dragging: no-drag !important;}
  
  background: transparent !important;
  color: var(--txt-color) !important;
  border: 0px solid transparent !important;
  
  padding: 0px !important;
  padding-bottom: calc( var(--margin) / 1.5 ) !important;
  
  &:has(.expanded-button) { padding-inline: var(--toolbar-start-end-padding) !important; }
  
  min-width: 0px !important;
  .tools-and-extensions, .bottom-actions { padding-inline: 0px !important }
  
  :is(.tools-and-extensions, .bottom-actions) moz-button { margin-block-start: 4px !important; }
}

/* sidebar buttons */
:is(.tools-and-extensions, .bottom-actions) moz-button {
  --button-outer-padding-inline-start: 4px !important;
  --button-outer-padding-inline-end: 4px !important;
  --button-outer-padding-block-start: 0px !important;
  --button-outer-padding-block-end: 0px !important;

  --button-min-height: 32px;

  --button-padding-icon: 14px !important;
  --button-size-icon: 32px !important;
}


/* tabs expanded */
#vertical-tabs #tabbrowser-tabs[expanded]{
  
  /* not pinned tabs */
  .tabbrowser-tab:not([pinned]){
    --tab-min-height: 32px !important;
    &, & > * {max-height: 32px !important;}

    margin-block: 3px !important;

    .tab-content{
      padding: 0px !important;
      padding-inline-end: 5px !important;
      padding-inline-start: 10px !important;
    }
    .tab-background{
      margin: 0px !important;
      border-radius: var(--rounding) !important;
      &, & > *{max-height: 32px !important;}
    }

    .tab-close-button{ margin: 0px !important; }
  }
  
  /* new tab button */
  #tabs-newtab-button{   
    --tab-min-height: 32px !important;
    &, & > * {max-height: 32px !important;}
    border-radius: var(--rounding) !important;
    margin: 0px !important; 
    margin-block: 3px !important;
  }
  
  /* pinned tabs */
  #vertical-pinned-tabs-container{
    padding-inline: 0px !important;
    display: flex !important;
    flex-wrap: wrap;
    flex-direction: row;

    --grid-gap: 5px;
    width: calc( 100% + var(--grid-gap) ) !important;
    grid-gap: var(--grid-gap) !important;

    .tabbrowser-tab[pinned]{
      --wm: 3; --hm: 1; min-width: 0px !important;
      width: calc( 100% / var(--wm) - var(--grid-gap) ) !important;
      height: calc( var(--sdbr-wdt) / 4.6 / var(--hm) ) !important;
    }

    .tabbrowser-tab[pinned]:nth-child(1):last-child
    {--wm: 1; --hm: 1.4;}

    &:has(.tabbrowser-tab:nth-child(3n + 2):last-child)
    .tabbrowser-tab:nth-last-child(-n + 2)
    {--wm: 2; --hm: 1.2;}

    &:has(.tabbrowser-tab:nth-child(3n + 4):last-child)
    .tabbrowser-tab:nth-last-child(-n + 4)
    {--wm: 4; --hm: 1.3;}

    .tabbrowser-tab[pinned] .tab-background{
      margin: 0px !important;
      border-radius: var(--big-rounding) !important;
      height: 100% !important;
      width: 100% !important;
    }

    .tab-icon-image, .tab-icon-stack{
      height: var(--pinned-tab-icon-size) !important;
      width: var(--pinned-tab-icon-size) !important;
    }
  }
}

/* tabs not expanded */
#vertical-tabs #tabbrowser-tabs:not([expanded]){
  --tab-collapsed-width: 40px !important;
  --tab-collapsed-background-width: 32px !important;
  --tab-min-height: 32px;
  
  .tab-background, #tabs-newtab-button{ 
    margin-inline: 4px !important; 
    border-radius: var(--rounding) !important; 
  }
  
  #tabs-newtab-button{ margin-top: 2px !important; }
}

#vertical-pinned-tabs-container-separator{ margin: 0px !important; }

:root:not([titlepreface*="á Ž"]) #vertical-pinned-tabs-container:not(:empty){ margin-top: var(--margin) !important; }

/* rm scrollbars */
#tabbrowser-arrowscrollbox, #vertical-pinned-tabs-container{
  --vertical-tabs-scrollbox-width: none;
}

scrollbox, #vertical-pinned-tabs-container{
  scrollbar-width: var(--vertical-tabs-scrollbox-width) !important;
}